# 인공신경망

: 컬럼 몇개를 모아서 컬럼 하나로 만들고 그거를 또 여러개 붙여서 하나 만들어서 도식화 한 것이 신경망을 닮아서 이름을 인공신경망이라 한다.

-   알파고는 인공신경망 로직으로 되어있다.

-   딥러닝 역시 인공신경망에서 쓰이는 방법 중 하나다.

-   머신러닝 안에 딥러닝이 들어있다.

-   인공지능은 머신러닝이다 라고 알면 된다.

## 선형분류와 비선형 분류

-   선형 회귀식은 모두 선형 분류이다. 하지만 이렇게 선형적인 데이터는 많지 않다.

-   다항 회귀식이 비선형 분류에 해당 된다. 여기에 해당되는 것이 딥러닝이라고 알고 있자.

    -   비선형 분류를 하기 위해서 이걸 범위를 나누어야 하는데 이를 알고리즘으로 구현한다고 생각하면 된다.

## 머신러닝과 딥러닝 차이

-   선형회귀 : 정형화된 데이터 중 선형적인 데이터

-   머신러닝 : 정형화된 데이터 (text가 이에 해당 됨)

-   딥러닝 : 비정형 데이터 ( 음악, 영상 등이 이에 해당 됨)

## 인공신경망의 구조

-   입력층

-   은닉층

    -   알고리즘에 해당하는 것이 이에 해당한다.

    -   하나 뿐 밖에 없는 것을 인공신경망이라 한다.

    -   여러 개를 쌓는 경우를 딥러닝이라 한다.

    -   입력값과 출력값을 연결시켜주는 매개변수 값으로 채워지게 되는데, 전체 신경망의 성공여부가 은닉충의 역할에 달려 있음

-   출력층

## 인공신경망 학습 방법

1.  지도학습
    -   문제와 답을 알려주고 학습시키는 것

        -   객관식(category 맞추기) / 주관식 모두 가능하다.

        -   category 맞추기의 경우의 정확도가 주관식보다 높다.

    -   정답을 어떻게 맞추냐?

        -   학습을 통해 어떠한 길을 많이 지나가느냐에 따라서 이를 가지고 예측률이 나오는 것이다.
2.  비지도학습
    -   문제만 알려주면 자기가 알아서 답을 찾도록 학습시키는 것
3.  강화학습
    -   문제도 안주고 알아서 공부시키는 것

## 데이터 정제가 필요한 이유

-   학습용 데이터와 test용 데이터를 분리해야 된다.

-   그렇지 않게 되면 모든 데이터를 가지고 학습하게 되면 무조건 test를 맞추게 된다.

## \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--

## iris 데이터 가지고 인공신경망 구축하기

1.  iris sms 50개씩 iris의 종이 분류되어 있다. 이에 맞게 학습용 데이터와 검증용 데이터를 분리한다.

2.  학습용 데이터 만들기

```{r}
set.seed(1234)
```

```{r}
# 이전에 자기가 사용하고자 하는 데이터를 알맞게 정렬하고 정제해야 된다. 

# 모집단에 맞게 sampling 하기 위해 rowname 만들기
samp <- c(sample(1:50,35) , sample(51:100,35) , sample(101:150,35))
samp

data.train <- iris[samp,]
```

-   검증용 데이터 만들기

```{r}
data.test <- iris[-samp,]
```

-   데이터 분류 확인

```{r}
# 내가 sampling 한 것이 맞게 들어 갔는지 확인
# train 과 test의 컬럼별 범위와 평균값과 중앙값이 비슷한지 확인
summary(data.train)
summary(data.test)
```

-   인공신경망으로 학습시키기

```{r}
# nueron network library 불러오기
library(nnet)
```

-   모델 만들기 ( 개발자 입장에서 function 과 같다. )

    -   여기에서 함수식 이름이 model.nnet과 같다.

```{r}
# 맞추고 싶은 거 ~ 어떤 거를 가지고
# size 는 은닉층 갯수 ( default가 3개 이다. )
model.nnet <- nnet(Species ~ . , data.train , size = 3)
```

-   문제 및 정답 만들기

```{r}
# 문제
x <- subset(data.test , select = -Species)

# 정답
y <- data.test$Species
```

-   검증

```{r}
# 공부해서 test를 봐서 나온 답안지가 여기에 들어간다. 
# type 에는 class 와 raw 가 있다. 
# class -> 객관식 / raw -> 주관식
pred <- predict(model.nnet , x , type = "class" )
head(pred)
```

-   예측력 확인

```{r}
mean(pred == y) * 100
```

-   정오표 확인 ( 오답노트 같은 느낌 )

```{r}
table(pred, y)
```

-   사용가능하다고 판단되면 모든데이터를 기준으로 학습을 다시 해야 된다.

    -   더 똑똑한 아이를 만들어야 된다.

```{r}
model.nnet <- nnet(Species ~ . , iris ,size =  3)
```

## test 끝난 후 어떻게 써먹을 수 있을까?

예 ) Sepal.Length = 5.3 / Sepal.Width = 3.3 / Petal.Length = 1.6 / Petal.Width = 0.3

-   요부분이 logic으로 들어가게 되는 것

```{r}
# 한줄짜리 데이터프레임이 list이다. 

# predict에 넣는 값이 dataframe이므로 내가 측정한 값을 dataframe으로 만들어 줘야 된다. 
# column이름은 같게 해야 된다. 
collect <- data.frame(Sepal.Length = 5.3 , Sepal.Width = 3.3 , Petal.Length = 1.6 , Petal.Width = 0.3)

# 만든 데이터를 내가 만든 인공지능에 넣어주면 답을 준다. 
predict(model.nnet , collect ,type = "class")
```

-   범위를 넘는 값이 들어갔을 경우

    -   넘는 값은 회귀식으로 측정을 해서 보내준다.

    -   범위 체크를 JSP에서 해줘야 한다.

예 ) Sepal.Length = 9.3 / Sepal.Width = 2.2 / Petal.Length = 7.5 / Petal.Width = 3.5

```{r}
collect <- data.frame(Sepal.Length = 9.3 , Sepal.Width = 2.2 , Petal.Length = 7.5 , Petal.Width = 3.5)
predict(model.nnet , collect ,type = "class")
```

```{r}
summary(iris)
```

## \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--
